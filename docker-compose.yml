version: '3.3'

services:

    web:
        build:
            context: docker/web
            args:
                XDEBUG_CONFIG: remote_host=${XDEBUG_REMOTE_HOST}
                        remote_port=9000
                        remote_enable=On
                        remote_autostart=On
                PHP_IDE_CONFIG: serverName=${XDEBUG_SERVER_NAME}
        ports:
            - ${WEB_SERVER_PORT}:80
        volumes:
            - .:/enterprise/src
            - ./storage/db/mysql:/enterprise/mysql-data
        working_dir: /enterprise/src
        networks:
            - local

    elastic:
        build: docker/elasticsearch
        ports:
            - ${ELASTIC_SERVER_PORT}:9200
        volumes:
            - ./storage/db/elasticsearch:/usr/share/elasticsearch/data
        networks:
            - local

networks:
    local:
        driver: bridge
